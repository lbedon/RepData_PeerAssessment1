---
title: "Reproducible Research: Peer Assessment 1"
author: "Luis David Bedon Gomez"
date: "4 Mai 2017"
output: html_document
keep_md: true
---

## Introduction
The following report discuss the questions asked for the Course Project 1 of the reproducible Research Course of the Data Science Specialization from the Johns Hopkings University an Coursera, concearning the data about personal movement using activity monitoring devices.

## 1. Loading and preprocessing the data

### 1.1 Downloading and loading the data
The given data are stored in a zipped csv-File "activity.csv" and are loaded through the following routine:


```{r loading data}

setwd("~/Coursera/ReproducibleResearch")
library(dplyr)
library(ggplot2)

if(!file.exists("RepData_PeerAssessment1/activity.csv")){
  urldata<-"https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
  download.file(urldata,destfile = "activity.zip",method = "curl")
  unzip("activity.zip")
}

# NA-values are stored as "NA"
activity<-read.csv("activity.csv", stringsAsFactors = FALSE, na.strings = "NA")

```

### 1.2 Preprocessing the data

The loaded data were screened to understand the file using the following instruction:

```{r preprocessing}
str(activity)
```

Here we see the dimension of the file, the names of the columns, its classes and the content of the first rows.

The columns "steps" and "intervals"" are class "int", as we expect. Contrary, the column "date" is class "character" and we need it to be class "date". I will also
change the names of the columns by writing them with a capital letter.

The needed transformation goes as follows:

```{r as.Date}
activity$date<-as.Date(activity$date)
names(activity)<-c("Steps","Date","Interval")
class(activity$Date)
names(activity)
```
And now the class of "activity$step" is "date" as needed.

## 2. What is mean total number of steps taken per day?

To address this question, I use a pipeline as follows:

```{r stepsday}
stepsperday<-activity %>% group_by(Date) %>% summarize(SumDay=sum(Steps,na.rm=1),MeanDay=round(mean(Steps,na.rm=1),1),MedianDay=median(Steps,na.rm=1))
print(stepsperday)

```

Here, i generate with Dyplr-pipeline in one line of code a variable "stepsperday" with the columns:

* "Date" for the date
* "SumDay" for the total number of steps per day
* "MeanDay" for the mean of steps per day and
* "MedianDay"for the median of steps per day.

### 2.1 Histogram of the total number of steps per day

With this data, I generate a histogram showing the number of counts for the total number of steps in 1000-intervals:

```{r stepsdaygraphic}

ggplot()+
geom_histogram(data=stepsperday,aes(SumDay),binwidth=1000,colour=rgb(.5,.25,.75,1),fill=rgb(.5,.25,.75,.75))+
scale_x_continuous(name="Total number of steps taken each day \n Bin's width = 1000 ",breaks=seq(0,24000,2000),minor_breaks = seq(1000,24000,2000))+
scale_y_continuous(name="Counts",breaks=c(1,2,3,4,5,6,7,8,9,10))+
ggtitle("Histogram for the total number of steps taken each day")
  
```

### 2.2 Mean and Median of the total number of steps per day

The Mean and Median of the total number of steps per day can be also calculated from the data frame "stepsperday" as follows:

```{r stepsdaymean}
a1<-"The mean of total steps per day is:"
a2<-"The median of total steps per day is:"
paste(a1,round(mean(stepsperday$SumDay,na.rm = 1),0))
paste(a2,round(median(stepsperday$SumDay,na.rm = 1),0))

```

